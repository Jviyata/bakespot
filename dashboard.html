import React, { useState, useEffect } from 'react';
import 'styles.css';

const generateImages = (type, count) =>
    Array.from({ length: count }, (_, i) => ({
        src: `/images/${type.toLowerCase()}${i + 1}.jpg`,
        alt: `${type} ${i + 1}`,
        category: type
    }));

const images = [
    ...generateImages('Cake', 5),
    ...generateImages('Cookie', 5),
    ...generateImages('Pie', 5),
    ...generateImages('Treat', 5)
];

const shuffleImages = (array) => {
    let shuffled = [...array];
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
};

const PhotoGrid = () => {
    const [searchTerm, setSearchTerm] = useState('');
    const [filter, setFilter] = useState('');
    const [shuffledImages, setShuffledImages] = useState([]);

    useEffect(() => {
        setShuffledImages(shuffleImages(images));
    }, []);

    const handleFilterClick = (category) => {
        setFilter(prevFilter => (prevFilter === category ? '' : category));
    };

    const filteredImages = shuffledImages.filter(image =>
        image.alt.toLowerCase().includes(searchTerm.toLowerCase()) &&
        (filter === '' || image.category === filter)
    );

    return (
        <div className="container">
            <nav className="navbar">
                <div className="home_image">
                    <img src="/images/logo.png" alt="Website Logo" className="logo-image" />
                    <span className="logo-text">Photo Grid</span>
                </div>
                <input 
                    type="text" 
                    placeholder="Search images..." 
                    value={searchTerm} 
                    onChange={(e) => setSearchTerm(e.target.value)}
                    className="search-bar"
                />
                <div className="filters">
                    {['Cake', 'Cookie', 'Pie', 'Treat'].map(category => (
                        <button 
                            key={category} 
                            onClick={() => handleFilterClick(category)}
                            className={filter === category ? 'active' : ''}
                            aria-pressed={filter === category}
                        >
                            {category}
                        </button>
                    ))}
                    <button onClick={() => setFilter('')} className={!filter ? 'active' : ''}>
                        All
                    </button>
                </div>
            </nav>
            
            <div className="photo-grid">
                {filteredImages.length > 0 ? (
                    filteredImages.map((image, index) => (
                        <img key={index} src={image.src} alt={image.alt} className="photo-item" />
                    ))
                ) : (
                    <p className="no-results">No images found</p>
                )}
            </div>

            {/* Display all image sources */}
            <div className="image-list">
                <h3>All Image Sources</h3>
                <ul>
                    {images.map((image, index) => (
                        <li key={index}>{image.src}</li>
                    ))}
                </ul>
            </div>
        </div>
    );
};

export default PhotoGrid;
